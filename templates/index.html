<!DOCTYPE HTML>
<html lang="en">
<head>
    <title>Swinburne Library Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script type="text/javascript" src="//code.jquery.com/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.slim.js"></script>
    <script type="text/javascript" charset="utf-8">
        $(document).ready(function(){

            // socketio starts here 
            // namespace = '/test';
            // var socket = io.connect('http://' + document.domain + ':' + location.port + namespace);
            // socket.on('connect', function() {
            //     socket.emit('my event', {data: 'I\'m connected!'});
            //     $('#log').text('Client Connected');
            // });
            // socket.on('disconnect', function() {
            //     $('#log').text('Client Disconnected');
            // });
            // socket.on('my response1', function(msg1) {
            //     $('#rec').text('Area 1: ' + msg1.data);
            //     x = msg1.data;
            // });
            // socket.on('my response2', function(msg2) {
            //     $('#log').append('<br>Received2: ' + msg2.data);
            //     y = msg2.data
            // });
            // socketio ends here

            
        });
    </script>
</head>
<body>
    <nav class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0">
        <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="#">
            Swinburne Library Monitoring System
        </a>
    </nav>

    <p>


    <div id="content-wrapper">
        <div class="container-fluid">

            <!-- Title icon card-->
            <ol class="breadcrumb">
              <li class="breadcrumb-item">
                <a href="#">Dashboard</a>
              </li>
              <li class="breadcrumb-item active">Overview</li>
            </ol>

            <!-- Icon Cards-->
            <div class="row">
              <div class="col-xl-3 col-sm-6 mb-3">
                <div class="card text-white bg-primary o-hidden h-100">
                  <div class="card-body">
                    <div class="card-body-icon">
                      <i class="fas fa-fw fa-comments"></i>
                    </div>
                    <div class="mr-5">
                        Pi 1
                        <span id="pi-1-data"></span>
                    </div>
                  </div>
                  <a class="card-footer text-white clearfix small z-1" href="#">
                    <span class="float-left">Status:</span>
                    <span id="pi-1-status"></span>

                    <span class="float-right">
                      <i class="fas fa-angle-right"></i>
                    </span>
                  </a>
                </div>
              </div>
              <div class="col-xl-3 col-sm-6 mb-3">
                <div class="card text-white bg-warning o-hidden h-100">
                  <div class="card-body">
                    <div class="card-body-icon">
                      <i class="fas fa-fw fa-list"></i>
                    </div>
                    <div class="mr-5">
                        Pi 2
                        <span id="pi-2-data"></span>
                    </div>
                  </div>
                  <a class="card-footer text-white clearfix small z-1" href="#">
                    <span class="float-left">Status:</span>
                    <span id="pi-2-status"></span>
                    <span class="float-right">
                      <i class="fas fa-angle-right"></i>
                    </span>
                  </a>
                </div>
              </div>
              <div class="col-xl-3 col-sm-6 mb-3">
                <div class="card text-white bg-success o-hidden h-100">
                  <div class="card-body">
                    <div class="card-body-icon">
                      <i class="fas fa-fw fa-shopping-cart"></i>
                    </div>
                    <div class="mr-5">Pi 3</div>
                  </div>
                  <a class="card-footer text-white clearfix small z-1" href="#">
                    <span class="float-left">Status:</span>
                    <span class="float-right">
                      <i class="fas fa-angle-right"></i>
                    </span>
                  </a>
                </div>
              </div>
              <div class="col-xl-3 col-sm-6 mb-3">
                <div class="card text-white bg-danger o-hidden h-100">
                  <div class="card-body">
                    <div class="card-body-icon">
                      <i class="fas fa-fw fa-life-ring"></i>
                    </div>
                    <div class="mr-5">Pi 4</div>
                  </div>
                  <a class="card-footer text-white clearfix small z-1" href="#">
                    <span class="float-left">Status:</span>
                    <span class="float-right">
                      <i class="fas fa-angle-right"></i>
                    </span>
                  </a>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-xl-2 col-sm-6 mb-3">
                <div class="card text-white bg-primary o-hidden h-100">
                  <div class="card-body">
                    <div class="card-body-icon">
                      <i class="fas fa-fw fa-comments"></i>
                    </div>
                    <div class="mr-5">Pi 5</div>
                  </div>
                  <a class="card-footer text-white clearfix small z-1" href="#">
                    <span class="float-left">Status:</span>
                    <span class="float-right">
                      <i class="fas fa-angle-right"></i>
                    </span>
                  </a>
                </div>
              </div>
              <div class="col-xl-2 col-sm-6 mb-3">
                <div class="card text-white bg-primary o-hidden h-100">
                  <div class="card-body">
                    <div class="card-body-icon">
                      <i class="fas fa-fw fa-comments"></i>
                    </div>
                    <div class="mr-5">Pi 6</div>
                  </div>
                  <a class="card-footer text-white clearfix small z-1" href="#">
                    <span class="float-left">Status:</span>
                    <span class="float-right">
                      <i class="fas fa-angle-right"></i>
                    </span>
                  </a>
                </div>
              </div>
              <div class="col-xl-2 col-sm-6 mb-3">
                <div class="card text-white bg-primary o-hidden h-100">
                  <div class="card-body">
                    <div class="card-body-icon">
                      <i class="fas fa-fw fa-comments"></i>
                    </div>
                    <div class="mr-5">Pi 7</div>
                  </div>
                  <a class="card-footer text-white clearfix small z-1" href="#">
                    <span class="float-left">Status:</span>
                    <span class="float-right">
                      <i class="fas fa-angle-right"></i>
                    </span>
                  </a>
                </div>
              </div>
              <div class="col-xl-2 col-sm-6 mb-3">
                <div class="card text-white bg-primary o-hidden h-100">
                  <div class="card-body">
                    <div class="card-body-icon">
                      <i class="fas fa-fw fa-comments"></i>
                    </div>
                    <div class="mr-5">Pi 8</div>
                  </div>
                  <a class="card-footer text-white clearfix small z-1" href="#">
                    <span class="float-left">Status:</span>
                    <span class="float-right">
                      <i class="fas fa-angle-right"></i>
                    </span>
                  </a>
                </div>
              </div>
              <div class="col-xl-2 col-sm-6 mb-3">
                <div class="card text-white bg-primary o-hidden h-100">
                  <div class="card-body">
                    <div class="card-body-icon">
                      <i class="fas fa-fw fa-comments"></i>
                    </div>
                    <div class="mr-5">Pi 9</div>
                  </div>
                  <a class="card-footer text-white clearfix small z-1" href="#">
                    <span class="float-left">Status:</span>
                    <span class="float-right">
                      <i class="fas fa-angle-right"></i>
                    </span>
                  </a>
                </div>
              </div>
              <div class="col-xl-2 col-sm-6 mb-3">
                <div class="card text-white bg-primary o-hidden h-100">
                  <div class="card-body">
                    <div class="card-body-icon">
                      <i class="fas fa-fw fa-comments"></i>
                    </div>
                    <div class="mr-5">Pi 10 (Extra)</div>
                  </div>
                  <a class="card-footer text-white clearfix small z-1" href="#">
                    <span class="float-left">Status:</span>
                    <span class="float-right">
                      <i class="fas fa-angle-right"></i>
                    </span>
                  </a>
                </div>
              </div>
            </div>


            <!--Chart parts-->
            <div class="card mb-3">
                <div class="card-header">
                    <h1 id="date" class="h3"></h1>
                </div>
                <div class="card-body">
                    <div id="chart">
                    </div>
                </div>
            </div>
        </div>
    </div>  

    
   
    
    <script>
        var n =  new Date();
        var y = n.getFullYear();
        var m = n.getMonth();
        var d = n.getDate();
        var c = n.getDay();

        const HIGH = "High";
        const MEDIUM = "Medium";
        const LOW = "Low";

        const months = ["Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
        const days = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];

        document.getElementById("date").innerHTML = days[c-1] + " " + d + "-" + months[m] + "-" + y;
        
        namespace ='/test';
        var number = 0;
        
        //create plotly line
        Plotly.plot('chart',[{
            x:[new Date()],
            y:[number],
            name:'Pi 1',
            type:'line' 
        }]);
        
        Plotly.plot('chart',[{
            x:[new Date()],
            y:[number],
            name:'Pi 2',
            type:'line' 
        }]);

        var socket = io.connect('http://' + document.domain + ':' + location.port + namespace);  
        
        socket.on('my response1', function(passedVariable){         
            console.log("VARIABLE PASS " + passedVariable.data);

            Plotly.extendTraces('chart',{
                    x:[[new Date()]],
                    y:[[passedVariable.data]],
                },[0]);

            document.getElementById("pi-1-data").innerHTML = parseFloat(Math.round(passedVariable.data * 100) / 100).toFixed(2);

            if(passedVariable.data >= 30){
                document.getElementById("pi-1-status").innerHTML = HIGH;
                document.getElementById("pi-1-status").style.color="#ff0000";
                // alert("fkcing noisy");
                // return false;
            }else{
                document.getElementById("pi-1-status").innerHTML = LOW;
                document.getElementById("pi-1-status").style.color="#228B22";
            }
        });

        socket.on('my response2', function(passedVariable2){         
            console.log("VARIABLE PASS " + passedVariable2.data);
            
            Plotly.extendTraces('chart',{
                x:[[new Date()]],
                y:[[passedVariable2.data]],
            },[1]);

            document.getElementById("pi-2-data").innerHTML = parseFloat(Math.round(passedVariable2.data * 100) / 100).toFixed(2);

            if(passedVariable2.data >= 30){
                document.getElementById("pi-2-status").innerHTML = HIGH;
                document.getElementById("pi-2-status").style.color="#ff0000";
            }else{
                document.getElementById("pi-2-status").innerHTML = LOW;
                document.getElementById("pi-2-status").style.color="#228B22";
            } 
        });
        
    </script>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <div><p id="log" class="ml-5"></p></div>
    <div><p id="rec" class="ml-5"></p></div>
</body>
</html>